<!DOCTYPE html>
<html>
<head>
	<title>rubyann tests</title>
	<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
	<link rel="stylesheet" href="http://github.com/jquery/qunit/raw/master/qunit/qunit.css" type="text/css"/>
	<link type="text/css" media="screen" rel="stylesheet" href="furigana.css"/>

	<script type="text/javascript" src="http://github.com/jquery/qunit/raw/master/qunit/qunit.js"> </script>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"> </script>
	<script type="text/javascript" src="jquery.rubyann.js"> </script>
</head>
<body id="bodyid">

<script language="javascript" type="text/javascript">

// detabify - remove tabs, convenience function
String.prototype.detabify=function(){
 return this.replace(/\t*/g, '');
};

var BirdRubyXml = "bird = <ruby><rb>鳥</rb><rp>(</rp><rt>とり</rt><rp>)</rp></ruby>";

module("Finding");
test("should annotate 1 kanji with 2 hiragana", function() {

	$("#1kanji_2hiragana").rubyann();
	equals($("#1kanji_2hiragana").html().detabify(), BirdRubyXml,
		"ruby xml should be generated");
});

test("finds nothing - no ruby xml", function() {

	$("#nothing").rubyann();
	equals( $("#nothing").html(), "no delimiters here", "no ruby xml is generated");
});

test("finds delimiters but no comma - no ruby xml", function() {

	$("#empty_braces").rubyann();
	equals( $("#empty_braces").html(), "delimiters found but {no comma within}", "no ruby xml is generated");
});

test("finds delimiters & comma but no characters - no ruby xml", function() {

	$("#no_characters").rubyann();
	equals( $("#no_characters").html(), "no characters {,}", "no ruby xml is generated");
});

test("should annotate multiple furigana", function() {

	$("#multiple_furigana").rubyann();
	equals( $("#multiple_furigana").html().detabify(), "japanese language - <ruby><rb>日</rb><rp>(</rp><rt>に</rt><rp>)</rp></ruby><ruby><rb>本</rb><rp>(</rp><rt>ほん</rt><rp>)</rp></ruby><ruby><rb>語</rb><rp>(</rp><rt>ご</rt><rp>)</rp></ruby>",
		"ruby xml is generated");
});

test("use @ as delimiter", function() {

	$("#delimiter_at").rubyann({delimiters:"@@"});
	equals( $("#delimiter_at").html().detabify(), BirdRubyXml, "ruby xml is generated");
});

test("use [] as delimiters", function() {

	$("#delimiter_squarebrackets").rubyann({delimiters:"[]"});
	equals( $("#delimiter_squarebrackets").html().detabify(), BirdRubyXml, "ruby xml is generated");
});

</script>

	<!--qunit ui-->
	<h1 id="qunit-header">QUnit Test Suite</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>

	<!--test data-->
	<hr/>
	<div id="1kanji_2hiragana">bird = {鳥,とり}</div>
	<div id="nothing">no delimiters here</div>
	<div id="empty_braces">delimiters found but {no comma within}</div>
	<div id="no_characters">no characters {,}</div>
	<div id="multiple_furigana">japanese language - {日,に}{本,ほん}{語,ご}</div>
	<div id="delimiter_at">bird = @鳥,とり@</div>
	<div id="delimiter_squarebrackets">bird = [鳥,とり]</div>

</body>
</html>